# CNN

CNN은 Convolutional Neural Network의 약자로 일반 DNN에서 이미지나 영상과 같은 데이터를 처리할 때 발생하는 문제점들을 보완한 방법입니다.

## CNN의 처리방법

### 1. 픽셀화

아래와 같은 손글씨 이미지가 있다고 합시다.

<이미지 1>

이와 같은 이미지에 대해서 픽셀로 나눠볼 수 있습니다.

<이미지 2>

위의 빨간 네모 한칸을 1픽셀이라 생각하고, 이 픽셀에는 (R(0~255), G(0~255), B(0~255)) 사이의 컬러가 들어가 있습니다.

즉 한픽셀당 3차원의 값이 들어가게 되는 것입니다.

그러나 지금은 개념만 잡는 부분이기 때문에 이해하기 쉽도록 0과 1로만 구분이 된다고 생각해봅시다.

그렇게 된다면 아래와 같이 숫자 "8"을 나타낼 수 있습니다.
(흰 픽셀은 0, 나머지 픽셀은 1)

<이미지 3>

**CNN에서는 이 이미지의 한 픽셀과, 주변 픽셀들의 연관관계를 유지시키며 학습시키는 것을 목표로 합니다.**

### 2. Convolution
우선은 하나의 이미지로부터 픽셀의 연관성을 살린 여러 개의 이미지를 생성합니다.

n*n 크기의 이미지를 뽑아내서 같은 크기의 랜덤값을 가지고 있는 데이터와 픽셀을 곱해서 더해줍니다.

이때 랜덤값을 가지고 있는 n*n 데이터를 필터라고 부릅니다.

필터를 한픽셀씩 옮기며 새로운 이미지를 완성하는 방식입니다.

이렇게 새 이미지를 생성하는 방법이 Convolution입니다.

수학적으로 다시 정리해보겠습니다.


필터 갯수 = X
필터 크기 = Y

이미지 크기 = Z * Z

-> 이때 만들어지는 새 이미지 크기와 갯수 : 크기 = (Z-Y+1) * (Z-Y+1), 갯수 = Y개

이번에는 아까의 숫자 8 그림에 대해 Convolution 해봅시다.

아래 같은 3 * 3 필터 3개를 준비했다고 가정합시다.

<이미지 4>

그리고 아까 픽셀화를 한 숫자 8 이미지의 크기는 28 * 28입니다.

필터 1번이 한칸씩 움직이면서 새로운 이미지를 만들게 됩니다.

이때 만들어지는 이미지는 (28-3+1) * (28-3+1), 즉 26 * 26 크기의 새로운 이미지를 만들게 됩니다.

이러한 과정을 필터갯수인 3번 반복하면, 26 * 26의 이미지 3개가 완성됩니다.

필터의 갯수가 수백개이면, 이미지 하나를 서로다른 수백개의 이미지로 표현할 수 있습니다. 즉 이미지 100개에 필터 100개를 사용한다면 10000개의 Convolution된 이미지들을 얻을 수 있는 것입니다.